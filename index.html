<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>чипсики</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="styles.css">
</head>

<body>

<div class="background">
    <img src="background.jpeg" alt="background" class="bg-image">
</div>
<audio id="bg-audio" src="background.mp3" loop></audio>
    
<div id="start-screen">
    <div class="start-title">Tap to enter</div>
</div>

<div class="container">

    <div class="section hero">
        <div class="avatar">
            <video autoplay muted loop playsinline>
                <source src="6024557-uhd_2160_3840_30fps.mp4" type="video/mp4">
            </video>
            <img src="avatar.png" alt="avatar" class="avatar-fallback">
        </div>
        <h1>Wiskas</h1>
        <p class="bio-desc">Вам картошку фри или гамбургер?</p>
        <p class="bio-location"> <i class="fa-solid fa-location-dot"></i> Подвал </p>
        <div class="socials">
            <a href="https://discord.gg/1315927053559791637" target="_blank">
                <i class="fa-brands fa-discord"></i>
            </a>
            <a href="https://t.me/wiskas_n" target="_blank">
                <i class="fa-brands fa-telegram"></i>
            </a>
        </div>
        <div class="views-fixed">
            <i class="fa-solid fa-eye"></i>
            <span id="views">0</span>
        </div>
    </div>

</div>

<script>
const startScreen = document.getElementById('start-screen');
const audio = document.getElementById('bg-audio');

startScreen.addEventListener('click', () => {
    audio.volume = 0.55;
    audio.play().catch(() => {});
    startScreen.classList.add('hidden');
});
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, doc, setDoc, increment, onSnapshot }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSy...",
  authDomain: "wiskas.firebaseapp.com",
  projectId: "wiskas",
  storageBucket: "wiskas.firebasestorage.app",
  messagingSenderId: "168046348967",
  appId: "1:168046348967:web:618ed62b398042861ca982"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const bioRef = doc(db, "stats", "bio");

async function incrementViewOnce() {
  const counted = localStorage.getItem("bio_view_counted");

  if (!counted) {
    await setDoc(
      bioRef,
      { views: increment(1) },
      { merge: true }
    );

    localStorage.setItem("bio_view_counted", "true");
  }
}

incrementViewOnce();

onSnapshot(bioRef, snap => {
  if (!snap.exists()) return;

  const data = snap.data();
  document.getElementById("views").textContent =
    data.views || 0;
});

document.querySelectorAll(".link-item").forEach(link => {
  link.addEventListener("click", async (e) => {
    const field = link.dataset.id;
    if (!field) return;

    e.preventDefault();

    await setDoc(
      bioRef,
      {
        clicks_total: increment(1),
        [field]: increment(1)
      },
      { merge: true }
    );

    window.location.href = link.href;
  });
});
</script>




</body>

</html>


